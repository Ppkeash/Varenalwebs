{% comment %}
  VARENAL Reviews v3 — Ultra-Creative + Latino Names
  Social proof with animated stats + 6 review cards.
  Glass-morphism cards, gradient accents, staggered entrance.
{% endcomment %}

<section id="reviews" class="varenal-reviews" {{ section.shopify_attributes }}>
  {%- comment -%} Subtle background decor {%- endcomment -%}
  <div class="rev__bg" aria-hidden="true">
    <div class="rev__bg-orb rev__bg-orb--1"></div>
    <div class="rev__bg-orb rev__bg-orb--2"></div>
  </div>

  <div class="varenal-section">

    {%- comment -%} Header {%- endcomment -%}
    <div class="rev__header animate-on-scroll" data-delay="0">
      <span class="varenal-badge rev__eyebrow">
        {{ section.settings.eyebrow | default: 'RESULTADOS REALES' }}
      </span>
      <h2 class="rev__heading">
        {{ section.settings.heading | default: 'Únete a las 2,300+ personas que finalmente encontraron alivio' }}
      </h2>
      <p class="rev__subtitle">Miles de personas confían en VARENAL para su recuperación diaria.</p>
    </div>

    {%- comment -%} Stats Bar {%- endcomment -%}
    <div class="rev__stats animate-on-scroll" data-delay="1" id="reviews-stats">
      <div class="rev__stat">
        <span class="rev__stat-number" data-count-target="4.9" data-count-decimal="1">0</span>
        <span class="rev__stat-label">
          <span class="rev__stat-stars" aria-label="5 estrellas">
            {%- for i in (1..5) -%}
              <svg width="16" height="16" viewBox="0 0 24 24" fill="#00B4C8" aria-hidden="true"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
            {%- endfor -%}
          </span>
          Puntuación media
        </span>
      </div>
      <div class="rev__stat-divider"></div>
      <div class="rev__stat">
        <span class="rev__stat-number" data-count-target="2300" data-count-suffix="+">0</span>
        <span class="rev__stat-label">Reseñas verificadas</span>
      </div>
      <div class="rev__stat-divider"></div>
      <div class="rev__stat">
        <span class="rev__stat-number" data-count-target="98" data-count-suffix="%">0</span>
        <span class="rev__stat-label">Lo recomendarían</span>
      </div>
    </div>

    {%- comment -%} Reviews Grid {%- endcomment -%}
    <div class="rev__grid">

      {%- comment -%} Card 1 — Carolina R. {%- endcomment -%}
      <div class="rev__card animate-on-scroll" data-delay="1">
        <div class="rev__card-accent" aria-hidden="true"></div>
        <div class="rev__card-top">
          <div class="rev__avatar rev__avatar--teal">CR</div>
          <div class="rev__card-meta">
            <span class="rev__name">Carolina R.</span>
            <span class="rev__verified">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#10B981" stroke-width="3"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
              Compra verificada
            </span>
          </div>
        </div>
        <div class="rev__stars" aria-label="5 de 5 estrellas">
          {%- for i in (1..5) -%}
            <svg width="16" height="16" viewBox="0 0 24 24" fill="#FFB800" aria-hidden="true"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
          {%- endfor -%}
        </div>
        <h4 class="rev__title">Me cambió la vida en mis turnos</h4>
        <p class="rev__body" data-review-body>Soy enfermera y estoy de pie más de 12 horas al día. Después de la primera sesión, literalmente lloré de alivio. El calor es increíble y se mantiene en su lugar todo el tiempo. No puedo recomendarlo lo suficiente.</p>
        <span class="rev__date">Enero 2026</span>
      </div>

      {%- comment -%} Card 2 — Andrés M. {%- endcomment -%}
      <div class="rev__card animate-on-scroll" data-delay="2">
        <div class="rev__card-accent" aria-hidden="true"></div>
        <div class="rev__card-top">
          <div class="rev__avatar rev__avatar--orange">AM</div>
          <div class="rev__card-meta">
            <span class="rev__name">Andrés M.</span>
            <span class="rev__verified">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#10B981" stroke-width="3"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
              Compra verificada
            </span>
          </div>
        </div>
        <div class="rev__stars" aria-label="5 de 5 estrellas">
          {%- for i in (1..5) -%}
            <svg width="16" height="16" viewBox="0 0 24 24" fill="#FFB800" aria-hidden="true"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
          {%- endfor -%}
        </div>
        <h4 class="rev__title">Mejor que mis visitas al fisio</h4>
        <p class="rev__body" data-review-body>Me torcí el tobillo jugando baloncesto. Este dispositivo redujo mi recuperación a la mitad. La combinación de vibración y calor es otra cosa — mi fisio literalmente me preguntó qué estaba usando.</p>
        <span class="rev__date">Febrero 2026</span>
      </div>

      {%- comment -%} Card 3 — María L. {%- endcomment -%}
      <div class="rev__card animate-on-scroll" data-delay="3">
        <div class="rev__card-accent" aria-hidden="true"></div>
        <div class="rev__card-top">
          <div class="rev__avatar rev__avatar--teal">ML</div>
          <div class="rev__card-meta">
            <span class="rev__name">María L.</span>
            <span class="rev__verified">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#10B981" stroke-width="3"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
              Compra verificada
            </span>
          </div>
        </div>
        <div class="rev__stars" aria-label="5 de 5 estrellas">
          {%- for i in (1..5) -%}
            <svg width="16" height="16" viewBox="0 0 24 24" fill="#FFB800" aria-hidden="true"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
          {%- endfor -%}
        </div>
        <h4 class="rev__title">Perfecto para toda la familia</h4>
        <p class="rev__body" data-review-body>Mi mamá lo usa para la artritis y yo después del gimnasio. La batería dura muchísimo y la pantalla LED lo hace muy fácil de usar a cualquier edad. La mejor compra del año.</p>
        <span class="rev__date">Enero 2026</span>
      </div>

      {%- comment -%} Card 4 — Diego S. {%- endcomment -%}
      <div class="rev__card animate-on-scroll" data-delay="4">
        <div class="rev__card-accent" aria-hidden="true"></div>
        <div class="rev__card-top">
          <div class="rev__avatar rev__avatar--navy">DS</div>
          <div class="rev__card-meta">
            <span class="rev__name">Diego S.</span>
            <span class="rev__verified">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#10B981" stroke-width="3"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
              Compra verificada
            </span>
          </div>
        </div>
        <div class="rev__stars" aria-label="4 de 5 estrellas">
          {%- for i in (1..4) -%}
            <svg width="16" height="16" viewBox="0 0 24 24" fill="#FFB800" aria-hidden="true"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
          {%- endfor -%}
          <svg width="16" height="16" viewBox="0 0 24 24" fill="#E5E7EB" aria-hidden="true"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
        </div>
        <h4 class="rev__title">Gran producto, envío rápido</h4>
        <p class="rev__body" data-review-body>Funciona exactamente como dice. Los tres niveles de calor se sienten notablemente diferentes. Me gustaría que viniera en blanco también, pero el negro se ve muy elegante. El envío fue más rápido de lo esperado.</p>
        <span class="rev__date">Diciembre 2025</span>
      </div>

      {%- comment -%} Card 5 — Ana P. {%- endcomment -%}
      <div class="rev__card animate-on-scroll" data-delay="5">
        <div class="rev__card-accent" aria-hidden="true"></div>
        <div class="rev__card-top">
          <div class="rev__avatar rev__avatar--teal">AP</div>
          <div class="rev__card-meta">
            <span class="rev__name">Ana P.</span>
            <span class="rev__verified">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#10B981" stroke-width="3"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
              Compra verificada
            </span>
          </div>
        </div>
        <div class="rev__stars" aria-label="5 de 5 estrellas">
          {%- for i in (1..5) -%}
            <svg width="16" height="16" viewBox="0 0 24 24" fill="#FFB800" aria-hidden="true"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
          {%- endfor -%}
        </div>
        <h4 class="rev__title">El regalo perfecto</h4>
        <p class="rev__body" data-review-body>Le regalé esto a mi abuela y no lo suelta. Dice que es lo mejor que le han dado en años. Es muy fácil de usar y el calor le alivia muchísimo las articulaciones. Totalmente recomendado.</p>
        <span class="rev__date">Enero 2026</span>
      </div>

      {%- comment -%} Card 6 — Sebastián V. {%- endcomment -%}
      <div class="rev__card animate-on-scroll" data-delay="6">
        <div class="rev__card-accent" aria-hidden="true"></div>
        <div class="rev__card-top">
          <div class="rev__avatar rev__avatar--orange">SV</div>
          <div class="rev__card-meta">
            <span class="rev__name">Sebastián V.</span>
            <span class="rev__verified">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#10B981" stroke-width="3"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
              Compra verificada
            </span>
          </div>
        </div>
        <div class="rev__stars" aria-label="5 de 5 estrellas">
          {%- for i in (1..5) -%}
            <svg width="16" height="16" viewBox="0 0 24 24" fill="#FFB800" aria-hidden="true"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
          {%- endfor -%}
        </div>
        <h4 class="rev__title">Hecho para atletas</h4>
        <p class="rev__body" data-review-body>Entreno 6 días a la semana y la fatiga del tobillo me frenaba. Ahora es innegociable en mi rutina de recuperación. La combinación calor-vibración es de nivel élite. Cero quejas.</p>
        <span class="rev__date">Febrero 2026</span>
      </div>

    </div>

    {%- comment -%} Submit review CTA {%- endcomment -%}
    <div class="rev__cta animate-on-scroll" data-delay="7">
      <p class="rev__cta-text">¿VARENAL también cambió tu vida?</p>
      <a href="{{ section.settings.review_url | default: '#' }}" class="btn-varenal-ghost">
        Comparte tu experiencia →
      </a>
    </div>

  </div>
</section>

{% stylesheet %}
  /* ============================================
     VARENAL REVIEWS v3 — Ultra-Creative
     ============================================ */

  .varenal-reviews {
    position: relative;
    background: #F8F9FA;
    overflow: hidden;
  }

  /* Floating orbs */
  .rev__bg { position: absolute; inset: 0; pointer-events: none; }

  .rev__bg-orb {
    position: absolute;
    border-radius: 50%;
    filter: blur(120px);
  }

  .rev__bg-orb--1 {
    width: 400px;
    height: 400px;
    background: rgba(0, 180, 200, 0.06);
    top: -120px;
    right: -80px;
    animation: glowPulse 10s ease-in-out infinite;
  }

  .rev__bg-orb--2 {
    width: 300px;
    height: 300px;
    background: rgba(255, 184, 0, 0.05);
    bottom: -80px;
    left: -60px;
    animation: glowPulse 10s ease-in-out 5s infinite;
  }

  /* Header */
  .rev__header {
    text-align: center;
    margin-bottom: 48px;
  }

  .rev__eyebrow { margin-bottom: 16px; }

  .rev__heading {
    font-family: var(--font-heading);
    font-weight: 800;
    font-size: 28px;
    line-height: 1.2;
    color: var(--color-text, #2D2D2D);
    margin-top: 20px;
    margin-bottom: 14px;
  }

  .rev__subtitle {
    font-family: var(--font-body);
    font-size: 16px;
    line-height: 1.7;
    color: var(--color-text-muted, #6B7280);
    max-width: 440px;
    margin: 0 auto;
  }

  /* Stats bar */
  .rev__stats {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 24px;
    text-align: center;
    margin-bottom: 56px;
    padding: 36px 28px;
    background: #FFFFFF;
    border-radius: 20px;
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.05);
    border: 1px solid rgba(0, 0, 0, 0.04);
  }

  .rev__stat-divider {
    width: 40px;
    height: 1px;
    background: #E5E7EB;
  }

  .rev__stat-number {
    display: block;
    font-family: var(--font-heading);
    font-weight: 800;
    font-size: 42px;
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1;
    margin-bottom: 8px;
  }

  .rev__stat-label {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    font-family: var(--font-body);
    font-size: 14px;
    color: var(--color-text-muted, #6B7280);
  }

  .rev__stat-stars { display: flex; gap: 2px; }

  /* Reviews grid */
  .rev__grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 20px;
    margin-bottom: 56px;
  }

  /* Card */
  .rev__card {
    position: relative;
    background: #FFFFFF;
    border-radius: 20px;
    padding: 32px 28px;
    box-shadow: 0 2px 16px rgba(0, 0, 0, 0.05);
    transition: all 0.4s var(--ease-spring);
    border: 1px solid rgba(0, 0, 0, 0.04);
    overflow: hidden;
  }

  .rev__card-accent {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: var(--gradient-primary);
    opacity: 0;
    transition: opacity 0.4s ease;
  }

  .rev__card:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1);
    border-color: rgba(0, 180, 200, 0.15);
  }

  .rev__card:hover .rev__card-accent { opacity: 1; }

  .rev__card-top {
    display: flex;
    align-items: center;
    gap: 14px;
    margin-bottom: 14px;
  }

  /* Avatar */
  .rev__avatar {
    width: 48px;
    height: 48px;
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: var(--font-heading);
    font-weight: 700;
    font-size: 15px;
    color: #FFFFFF;
    flex-shrink: 0;
  }

  .rev__avatar--teal   { background: linear-gradient(135deg, #00B4C8 0%, #0090A0 100%); }
  .rev__avatar--orange  { background: linear-gradient(135deg, #FF6B35 0%, #FF8F66 100%); }
  .rev__avatar--navy    { background: linear-gradient(135deg, #1A1A2E 0%, #252545 100%); }

  .rev__card-meta {
    display: flex;
    flex-direction: column;
    gap: 3px;
  }

  .rev__name {
    font-family: var(--font-body);
    font-weight: 600;
    font-size: 15px;
    color: var(--color-text, #2D2D2D);
  }

  .rev__verified {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 11px;
    color: var(--color-success, #10B981);
    font-weight: 600;
  }

  .rev__stars {
    display: flex;
    gap: 2px;
    margin-bottom: 12px;
  }

  .rev__title {
    font-family: var(--font-heading);
    font-weight: 700;
    font-size: 16px;
    color: var(--color-text, #2D2D2D);
    margin-bottom: 10px;
    line-height: 1.3;
  }

  .rev__body {
    font-family: var(--font-body);
    font-size: 14px;
    line-height: 1.7;
    color: var(--color-text-muted, #6B7280);
    margin-bottom: 14px;
  }

  .rev__body.is-clamped {
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
    overflow: hidden;
  }

  .rev__read-more {
    display: inline;
    background: none;
    border: none;
    color: var(--color-primary, #00B4C8);
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    padding: 0;
    font-family: var(--font-body);
  }

  .rev__date {
    font-size: 12px;
    color: var(--color-text-muted, #6B7280);
    opacity: 0.6;
  }

  /* CTA */
  .rev__cta { text-align: center; }

  .rev__cta-text {
    font-size: 15px;
    color: var(--color-text-muted, #6B7280);
    margin-bottom: 16px;
  }

  /* ========== Tablet (2 columns) ========== */
  @media (min-width: 600px) {
    .rev__grid { grid-template-columns: 1fr 1fr; }

    .rev__stats {
      flex-direction: row;
      justify-content: center;
      gap: 40px;
    }

    .rev__stat-divider {
      width: 1px;
      height: 48px;
    }
  }

  /* ========== Desktop ========== */
  @media (min-width: 769px) {
    .rev__heading { font-size: 42px; }

    .rev__stat-number { font-size: 60px; }

    .rev__grid {
      grid-template-columns: 1fr 1fr 1fr;
      gap: 24px;
    }
  }
{% endstylesheet %}

{% javascript %}
  (function() {
    'use strict';

    var section = document.getElementById('reviews');
    if (!section) return;

    /* --- CountUp animation for stats --- */
    var statsBar = document.getElementById('reviews-stats');
    var counted = false;

    function animateCountUp(el) {
      var target = parseFloat(el.getAttribute('data-count-target'));
      var suffix = el.getAttribute('data-count-suffix') || '';
      var isDecimal = el.hasAttribute('data-count-decimal');
      var decimalPlaces = isDecimal ? parseInt(el.getAttribute('data-count-decimal'), 10) : 0;
      var duration = 1800;
      var start = 0;
      var startTime = null;

      function step(timestamp) {
        if (!startTime) startTime = timestamp;
        var progress = Math.min((timestamp - startTime) / duration, 1);
        var eased = 1 - Math.pow(1 - progress, 3);
        var current = start + (target - start) * eased;

        if (decimalPlaces > 0) {
          el.textContent = current.toFixed(decimalPlaces) + suffix;
        } else {
          el.textContent = Math.floor(current).toLocaleString('en-US') + suffix;
        }

        if (progress < 1) requestAnimationFrame(step);
      }

      requestAnimationFrame(step);
    }

    if (statsBar) {
      var statsObserver = new IntersectionObserver(function(entries) {
        entries.forEach(function(entry) {
          if (entry.isIntersecting && !counted) {
            counted = true;
            var numbers = statsBar.querySelectorAll('[data-count-target]');
            numbers.forEach(function(num) { animateCountUp(num); });
            statsObserver.unobserve(entry.target);
          }
        });
      }, { threshold: 0.3 });
      statsObserver.observe(statsBar);
    }

    /* --- Scroll animation for cards & header --- */
    var scrollTargets = section.querySelectorAll('.animate-on-scroll');
    if (scrollTargets.length) {
      var cardObserver = new IntersectionObserver(function(entries) {
        entries.forEach(function(entry) {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            cardObserver.unobserve(entry.target);
          }
        });
      }, { threshold: 0.08, rootMargin: '0px 0px -40px 0px' });
      scrollTargets.forEach(function(el) { cardObserver.observe(el); });
    }

    /* --- Read more toggle for long reviews --- */
    var CHAR_LIMIT = 120;
    var reviewBodies = section.querySelectorAll('[data-review-body]');

    reviewBodies.forEach(function(body) {
      if (body.textContent.length > CHAR_LIMIT) {
        body.classList.add('is-clamped');
        var btn = document.createElement('button');
        btn.className = 'rev__read-more';
        btn.textContent = 'Leer más';
        btn.setAttribute('aria-expanded', 'false');

        btn.addEventListener('click', function() {
          var isClamped = body.classList.contains('is-clamped');
          body.classList.toggle('is-clamped');
          btn.textContent = isClamped ? 'Leer menos' : 'Leer más';
          btn.setAttribute('aria-expanded', String(isClamped));
        });

        body.parentNode.insertBefore(btn, body.nextSibling);
      }
    });
  })();
{% endjavascript %}

{% schema %}
{
  "name": "VARENAL Reviews",
  "tag": "section",
  "class": "varenal-reviews-section",
  "settings": [
    {
      "type": "text",
      "id": "eyebrow",
      "label": "Texto eyebrow",
      "default": "RESULTADOS REALES"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Título",
      "default": "Únete a las 2,300+ personas que finalmente encontraron alivio"
    },
    {
      "type": "url",
      "id": "review_url",
      "label": "Link para dejar reseña"
    }
  ],
  "presets": [
    {
      "name": "VARENAL Reviews"
    }
  ]
}
{% endschema %}
