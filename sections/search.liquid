{% comment %}
  VARENAL Search — Styled search page with results grid.
{% endcomment %}

<section class="varenal-search varenal-section">
  <div class="varenal-search__header">
    <h1 class="varenal-search__title">{{ 'search.title' | t }}</h1>

    <form action="{{ routes.search_url }}" method="get" class="varenal-search__form">
      <div class="varenal-search__input-wrap">
        <svg class="varenal-search__icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--color-text-muted, #6B7280)" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <input
          type="search"
          name="q"
          value="{{ search.terms | escape }}"
          class="varenal-input varenal-search__input"
          placeholder="{{ 'search.placeholder' | t }}"
          aria-label="{{ 'search.title' | t }}"
        >
        <button type="submit" class="btn-varenal-primary varenal-search__submit">
          {{ 'search.button' | t }}
        </button>
      </div>
    </form>
  </div>

  {% if search.performed %}
    <p class="varenal-search__results-count">
      {{ search.results_count }} {{ 'search.results_for' | t }} <strong>"{{ search.terms }}"</strong>
    </p>

    {% if search.results.size == 0 %}
      <div class="varenal-search__empty">
        <p>{{ 'search.no_results' | t }}</p>
        <a href="{{ routes.all_products_collection_url }}" class="btn-varenal-ghost">
          {{ 'collection.continue_shopping' | t }}
        </a>
      </div>
    {% else %}
      {%- paginate search.results by 12 -%}
        <div class="varenal-search__grid">
          {% for result in search.results %}
            <a href="{{ result.url }}" class="varenal-search-card">
              {% if result.featured_image %}
                <div class="varenal-search-card__image-wrap">
                  {{ result.featured_image | image_url: width: 400 | image_tag: class: 'varenal-search-card__image', loading: 'lazy' }}
                </div>
              {% endif %}
              <div class="varenal-search-card__body">
                <span class="varenal-search-card__type">{{ result.object_type }}</span>
                <h3 class="varenal-search-card__title">{{ result.title }}</h3>
                {% if result.object_type == 'product' %}
                  <span class="varenal-search-card__price">{{ result.price | money }}</span>
                {% else %}
                  <p class="varenal-search-card__excerpt">{{ result.content | strip_html | truncatewords: 16 }}</p>
                {% endif %}
              </div>
            </a>
          {% endfor %}
        </div>

        {% if paginate.pages > 1 %}
          <nav class="varenal-pagination" aria-label="Search">
            {% if paginate.previous %}
              <a href="{{ paginate.previous.url }}" class="varenal-pagination__btn">←</a>
            {% endif %}
            {% for part in paginate.parts %}
              {% if part.is_link %}
                <a href="{{ part.url }}" class="varenal-pagination__page">{{ part.title }}</a>
              {% elsif part.title == paginate.current_page %}
                <span class="varenal-pagination__page varenal-pagination__page--active">{{ part.title }}</span>
              {% else %}
                <span class="varenal-pagination__page">{{ part.title }}</span>
              {% endif %}
            {% endfor %}
            {% if paginate.next %}
              <a href="{{ paginate.next.url }}" class="varenal-pagination__btn">→</a>
            {% endif %}
          </nav>
        {% endif %}
      {%- endpaginate -%}
    {% endif %}
  {% endif %}
</section>

{% stylesheet %}
  .varenal-search__header {
    text-align: center;
    margin-bottom: 2.5rem;
  }

  .varenal-search__title {
    font-family: var(--font-heading, 'Montserrat', sans-serif);
    font-weight: 800;
    font-size: 2rem;
    margin-bottom: 1.5rem;
  }

  .varenal-search__form {
    max-width: 640px;
    margin: 0 auto;
  }

  .varenal-search__input-wrap {
    display: flex;
    align-items: center;
    gap: 0;
    background: var(--color-white, #fff);
    border: 2px solid rgba(0,0,0,0.08);
    border-radius: var(--radius-full, 999px);
    padding: 0.35rem 0.35rem 0.35rem 1.25rem;
    transition: border-color 0.2s, box-shadow 0.2s;
  }

  .varenal-search__input-wrap:focus-within {
    border-color: var(--color-primary, #00B4C8);
    box-shadow: 0 0 0 4px rgba(0, 180, 200, 0.12);
  }

  .varenal-search__icon {
    flex-shrink: 0;
    opacity: 0.5;
  }

  .varenal-search__input {
    flex: 1;
    border: none;
    background: transparent;
    padding: 0.6rem 0.75rem;
    font-size: 1rem;
    outline: none;
    box-shadow: none;
  }

  .varenal-search__input:focus { box-shadow: none; }

  .varenal-search__submit {
    flex-shrink: 0;
    border-radius: var(--radius-full, 999px);
    padding: 0.6rem 1.5rem;
    font-size: 0.9rem;
  }

  .varenal-search__results-count {
    text-align: center;
    font-size: 0.95rem;
    color: var(--color-text-muted, #6B7280);
    margin-bottom: 2rem;
  }

  .varenal-search__empty {
    text-align: center;
    padding: 4rem 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.5rem;
    color: var(--color-text-muted, #6B7280);
  }

  .varenal-search__grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
  }

  .varenal-search-card {
    display: flex;
    flex-direction: column;
    background: var(--color-white, #fff);
    border-radius: var(--radius-lg, 16px);
    overflow: hidden;
    box-shadow: var(--shadow-sm, 0 1px 3px rgba(0,0,0,0.06));
    border: 1px solid rgba(0,0,0,0.04);
    text-decoration: none;
    color: inherit;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .varenal-search-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-md, 0 4px 16px rgba(0,0,0,0.1));
  }

  .varenal-search-card__image-wrap {
    aspect-ratio: 1;
    overflow: hidden;
    background: var(--color-background, #F8F9FA);
  }

  .varenal-search-card__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.4s ease;
  }

  .varenal-search-card:hover .varenal-search-card__image {
    transform: scale(1.05);
  }

  .varenal-search-card__body {
    padding: 1rem 1.25rem 1.25rem;
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .varenal-search-card__type {
    font-family: var(--font-tech, 'Space Grotesk', sans-serif);
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--color-primary, #00B4C8);
  }

  .varenal-search-card__title {
    font-family: var(--font-heading, 'Montserrat', sans-serif);
    font-weight: 700;
    font-size: 0.95rem;
    color: var(--color-text, #2D2D2D);
  }

  .varenal-search-card__price {
    font-weight: 700;
    color: var(--color-primary, #00B4C8);
    font-size: 1.05rem;
  }

  .varenal-search-card__excerpt {
    font-size: 0.85rem;
    color: var(--color-text-muted, #6B7280);
    line-height: 1.5;
  }

  .varenal-pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.5rem;
    margin-top: 3rem;
  }

  .varenal-pagination__page,
  .varenal-pagination__btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 40px;
    height: 40px;
    border-radius: var(--radius-md, 8px);
    font-weight: 600;
    font-size: 0.9rem;
    text-decoration: none;
    color: var(--color-text, #2D2D2D);
    transition: background 0.2s, color 0.2s;
  }

  .varenal-pagination__page:hover,
  .varenal-pagination__btn:hover { background: var(--color-background, #F8F9FA); }

  .varenal-pagination__page--active {
    background: var(--color-primary, #00B4C8);
    color: #fff;
  }

  @media (max-width: 768px) {
    .varenal-search__grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }
    .varenal-search__title { font-size: 1.5rem; }
  }

  @media (max-width: 480px) {
    .varenal-search__grid { grid-template-columns: 1fr; }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:general.search",
  "settings": []
}
{% endschema %}
